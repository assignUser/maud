# TODO make this a proper subset of yaml
---
NAME: empty
TEMPLATE:
COMPILED:
RENDERED:
---


---
NAME: literal at
TEMPLATE:
Hello @@ world

COMPILED:

# literal 1:1-1:7
##################################################################################
# Hello @@ world
# ^~~~~^
##################################################################################
render([[Hello ]])

# @@ -> @ 1:8-1:8
##################################################################################
# Hello @@ world
#        ^
##################################################################################
render("@")

# literal 1:9-3:1
##################################################################################
# Hello @@ world
#         ^~~~~~~
#v
# 
##################################################################################
render([[ world

]])
RENDERED:
Hello @ world

---


# We exercise commands before variable substitution because there aren't
# any variables defined when the compiled cmake is included.
---
NAME: explicit render
TEMPLATE:
@render("foo\n")
COMPILED:

# commands 1:2-2:1
##################################################################################
# @render("foo\n")
#  ^~~~~~~~~~~~~~~~
#v
# 
##################################################################################
render("foo\n")

RENDERED:
foo
---


---
NAME: explicit render with variable
TEMPLATE:
@ set(FOO 1 2 3)
  render("${FOO}\n")
COMPILED:

# commands 1:2-3:1
##################################################################################
# @ set(FOO 1 2 3)
#  ^~~~~~~~~~~~~~~~
#v
# 
##################################################################################
 set(FOO 1 2 3)
  render("${FOO}\n")

RENDERED:
1;2;3
---


---
NAME: variable substitution
TEMPLATE:
@set(FOO 1 2 3)@@FOO@
COMPILED:

# commands 1:2-1:16
##################################################################################
# @set(FOO 1 2 3)@@FOO@
#  ^~~~~~~~~~~~~^
##################################################################################
set(FOO 1 2 3)

# reference 1:18-1:21
##################################################################################
# @set(FOO 1 2 3)@@FOO@
#                  ^~^
##################################################################################
render("${FOO}")

# literal 1:22-2:1
##################################################################################
# @set(FOO 1 2 3)@@FOO@
#                      ^
#v
# 
##################################################################################
render([[

]])
RENDERED:
1;2;3
---


---
NAME: if_else filter
TEMPLATE:
@include(MaudTemplateFilters)
set(TRUTHY ON)
set(FALSY OFF)
@@TRUTHY | if_else(1 0)@@FALSY | if_else(1 0)@
COMPILED:

# commands 1:2-4:1
##################################################################################
# @include(MaudTemplateFilters)
#  ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
#v
# @@TRUTHY | if_else(1 0)@@FALSY | if_else(1 0)@
##################################################################################
include(MaudTemplateFilters)
set(TRUTHY ON)
set(FALSY OFF)


# pipeline init 4:3-4:10
##################################################################################
# @@TRUTHY | if_else(1 0)@@FALSY | if_else(1 0)@
#   ^~~~~~^
##################################################################################
set(IT "${TRUTHY}")

# pipeline filter 4:12-4:24
##################################################################################
# @@TRUTHY | if_else(1 0)@@FALSY | if_else(1 0)@
#            ^~~~~~~~~~~^
##################################################################################
template_filter_if_else(1 0)

# pipeline output 4:24-4:24
##################################################################################
# @@TRUTHY | if_else(1 0)@@FALSY | if_else(1 0)@
#                        ^
##################################################################################
render("${IT}")

# pipeline init 4:26-4:32
##################################################################################
# @@TRUTHY | if_else(1 0)@@FALSY | if_else(1 0)@
#                          ^~~~~^
##################################################################################
set(IT "${FALSY}")

# pipeline filter 4:34-4:46
##################################################################################
# @@TRUTHY | if_else(1 0)@@FALSY | if_else(1 0)@
#                                  ^~~~~~~~~~~^
##################################################################################
template_filter_if_else(1 0)

# pipeline output 4:46-4:46
##################################################################################
# @@TRUTHY | if_else(1 0)@@FALSY | if_else(1 0)@
#                                              ^
##################################################################################
render("${IT}")

# literal 4:47-5:1
##################################################################################
# @@TRUTHY | if_else(1 0)@@FALSY | if_else(1 0)@
#                                               ^
#v
# 
##################################################################################
render([[

]])
RENDERED:
10
---


---
NAME: foreach filter
TEMPLATE:
@include(MaudTemplateFilters)
 set(BOOLY ON OFF OFF ON)@@BOOLY |foreach| if_else(1 0) |endforeach| join("-")@
COMPILED:

# commands 1:2-2:26
##################################################################################
# @include(MaudTemplateFilters)
#  ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
#~~~~~~~~~~~~~~~~~~~~~~~~~v
#  set(BOOLY ON OFF OFF ON)@@BOOLY |foreach| if_else(1 0) |endforeach| join("-")@
##################################################################################
include(MaudTemplateFilters)
 set(BOOLY ON OFF OFF ON)

# pipeline init 2:28-2:34
##################################################################################
#  set(BOOLY ON OFF OFF ON)@@BOOLY |foreach| if_else(1 0) |endforeach| join("-")@
#                            ^~~~~^
##################################################################################
set(IT "${BOOLY}")

# pipeline foreach 2:35-2:42
##################################################################################
#  set(BOOLY ON OFF OFF ON)@@BOOLY |foreach| if_else(1 0) |endforeach| join("-")@
#                                   ^~~~~~^
##################################################################################
set(foreach_IT_0)
foreach(IT ${IT})

# pipeline filter 2:44-2:57
##################################################################################
#  set(BOOLY ON OFF OFF ON)@@BOOLY |foreach| if_else(1 0) |endforeach| join("-")@
#                                            ^~~~~~~~~~~~^
##################################################################################
template_filter_if_else(1 0) 

# pipeline endforeach 2:58-2:68
##################################################################################
#  set(BOOLY ON OFF OFF ON)@@BOOLY |foreach| if_else(1 0) |endforeach| join("-")@
#                                                          ^~~~~~~~~^
##################################################################################
list(APPEND foreach_IT_1 "${IT}")
endforeach()
set(IT "${foreach_IT_1}")

# pipeline filter 2:70-2:79
##################################################################################
#  set(BOOLY ON OFF OFF ON)@@BOOLY |foreach| if_else(1 0) |endforeach| join("-")@
#                                                                      ^~~~~~~~^
##################################################################################
template_filter_join("-")

# pipeline output 2:79-2:79
##################################################################################
#  set(BOOLY ON OFF OFF ON)@@BOOLY |foreach| if_else(1 0) |endforeach| join("-")@
#                                                                               ^
##################################################################################
render("${IT}")

# literal 2:80-3:1
##################################################################################
#  set(BOOLY ON OFF OFF ON)@@BOOLY |foreach| if_else(1 0) |endforeach| join("-")@
#                                                                                ^
#v
# 
##################################################################################
render([[

]])
RENDERED:
1-0-0-1
